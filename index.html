<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Special Day üíñ</title>
    
    <!-- Google Fonts (Premium Look) -->
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;500&display=swap" rel="stylesheet">
    
    <style>
        /* ============ RESET & PREMIUM BASE ============ */
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: radial-gradient(circle at bottom, #1b2735 0%, #090a0f 100%);
            height: 100vh;
            overflow: hidden;
            font-family: 'Poppins', sans-serif;
            color: white;
            position: relative;
        }

        /* ============ INTRO OVERLAY (For Music Hack) ============ */
        #intro-overlay {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: #000;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: opacity 1.5s ease;
        }
        
        .intro-btn {
            padding: 15px 40px;
            border: 1px solid #ff4081;
            border-radius: 50px;
            color: #ff4081;
            font-size: 1.2rem;
            letter-spacing: 2px;
            text-transform: uppercase;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 64, 129, 0.7); } 70% { box-shadow: 0 0 0 20px rgba(255, 64, 129, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 64, 129, 0); } }

        /* ============ REALISTIC MOON ============ */
        .moon {
            position: absolute;
            top: 60px;
            left: 80px;
            width: 120px;
            height: 120px;
            background: transparent;
            border-radius: 50%;
            box-shadow: -25px 15px 0 0 #fffde7; /* Crescent */
            filter: drop-shadow(0 0 20px rgba(255, 255, 200, 0.5));
            opacity: 0.9;
            z-index: 2;
            animation: float 6s ease-in-out infinite alternate;
            transform: rotate(-25deg);
        }

        @keyframes float { from { transform: rotate(-25deg) translateY(0); } to { transform: rotate(-25deg) translateY(-15px); } }

        /* ============ TEXT CONTAINER ============ */
        #text-container {
            position: absolute;
            top: 25%;
            left: 10%;
            width: 500px;
            z-index: 10;
        }

        #special-heading {
            font-family: 'Dancing Script', cursive;
            font-size: 4rem;
            background: linear-gradient(to right, #ff8a00, #e52e71);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.2;
            margin-bottom: 20px;
            filter: drop-shadow(0 0 10px rgba(229, 46, 113, 0.3));
        }

        #special-msg {
            font-size: 1.1rem;
            line-height: 1.8;
            color: rgba(255,255,255,0.8);
            border-left: 3px solid #e52e71;
            padding-left: 20px;
        }

        .cursor {
            display: inline-block;
            width: 2px; height: 1.2em;
            background: #fff;
            animation: blink 1s infinite;
            vertical-align: bottom;
        }
        @keyframes blink { 50% { opacity: 0; } }

        /* ============ GLASSMORPHISM TIMER ============ */
        #timer-wrap {
            position: absolute;
            bottom: 15%;
            left: 10%;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
            z-index: 10;
        }
        
        .timer-title { font-size: 0.8rem; color: #aaa; letter-spacing: 2px; margin-bottom: 10px; text-transform: uppercase;}
        #timer { display: flex; gap: 20px; }
        .t-box { text-align: center; }
        .t-val { font-size: 2rem; font-weight: 700; display: block; color: #fff; text-shadow: 0 0 10px rgba(255,255,255,0.5); }
        .t-lbl { font-size: 0.8rem; color: rgba(255,255,255,0.6); }

        /* ============ CANVAS FOR TREE ============ */
        canvas {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 1;
        }
        
        /* Youtube Hidden */
        #player { display: none; }
        
    </style>
</head>
<body>

    <!-- CLICK TO START (Solves Audio Problem & Creates Suspense) -->
    <div id="intro-overlay">
        <div class="intro-btn">Tap to Open Your Gift üéÅ</div>
    </div>

    <!-- SCENE ELEMENTS -->
    <div class="moon"></div>
    
    <div id="text-container">
        <div id="special-heading"></div>
        <div id="special-msg"></div>
    </div>

    <div id="timer-wrap">
        <div class="timer-title">World Gets Luckier In</div>
        <div id="timer">
            <!-- Filled by JS -->
        </div>
    </div>

    <!-- CANVAS -->
    <canvas id="canvas"></canvas>

    <!-- YOUTUBE API WRAPPER -->
    <div id="player"></div>

    <script>
        // ============ 1. SETUP & CONFIG ============ //
        const CONFIG = {
            targetDate: "2025-12-13T00:00:00",
            texts: {
                before: {
                    head: "Coming Soon...",
                    msg: "The most beautiful day of the year is approaching.\nCounting every breath until 13th December 2025.\nYou are the best thing that happened to this world. ‚ù§Ô∏è"
                },
                after: {
                    head: "Happy Birthday!",
                    msg: "To my beautiful person,\nMay your life be as magical as this moment.\nStay blessed forever. I love you! üíñ"
                }
            },
            ytVideoID: "nAw2ooeubSQ" // Your requested song
        };

        // ============ 2. CANVAS GRAPHICS (STAR & TREE) ============ //
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        // --- Background Stars (Sparkling) ---
        const stars = Array(150).fill().map(() => ({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            r: Math.random() * 2,
            alpha: Math.random(),
            fading: Math.random() > 0.5
        }));

        function drawStars() {
            stars.forEach(star => {
                ctx.fillStyle = `rgba(255, 255, 255, ${star.alpha})`;
                ctx.beginPath();
                ctx.arc(star.x, star.y, star.r, 0, Math.PI * 2);
                ctx.fill();

                if(star.fading) { star.alpha -= 0.01; if(star.alpha <= 0.2) star.fading = false; }
                else { star.alpha += 0.01; if(star.alpha >= 1) star.fading = true; }
            });
        }

        // --- The Advanced Glowing Tree ---
        const branchColor = "#3e2723";
        // Different shades of Pink/Red/Magenta for hearts
        const bloomColors = ["#FF4081", "#FF80AB", "#F50057", "#ff9a9e"];
        
        let treeBranches = [];
        let treeBlooms = [];

        function growTree(x, y, len, angle, width) {
            // Add branch segment
            treeBranches.push({x, y, len, angle, width, currLen: 0});
            
            // Recursion for structure (data generation only)
            if(len > 15) {
                let newLen = len * 0.75;
                let newWidth = width * 0.7;
                // Two splits
                growTreeData(x + Math.sin(angle) * len, y - Math.cos(angle) * len, newLen, angle + Math.random() * 0.5 + 0.1, newWidth);
                growTreeData(x + Math.sin(angle) * len, y - Math.cos(angle) * len, newLen, angle - Math.random() * 0.5 - 0.1, newWidth);
            } else {
                // Add bloom location
                let bx = x + Math.sin(angle) * len;
                let by = y - Math.cos(angle) * len;
                treeBlooms.push({
                    x: bx, y: by, 
                    size: 0, 
                    maxSize: Math.random() * 15 + 5,
                    color: bloomColors[Math.floor(Math.random()*bloomColors.length)],
                    phase: Math.random() * Math.PI
                });
            }
        }

        // Since recursion is instant, we simulate it visually using arrays
        // For "Hibijibi free", we define a neat structure function
        function getEndpoint(x, y, len, angle) {
            return {
                x: x + Math.sin(angle) * len,
                y: y - Math.cos(angle) * len
            };
        }

        let frame = 0;
        // Hardcoding the root manually for cleanliness and then generating procedural branches dynamically during render
        // To Keep it Clean and Beautiful: We use a recursive Draw function
        
        function drawRecursiveTree(x, y, len, angle, width) {
            ctx.beginPath();
            ctx.save();
            ctx.translate(x, y);
            ctx.rotate(angle); // standard canvas rotation
            ctx.moveTo(0, 0);
            ctx.lineTo(0, -len);
            ctx.strokeStyle = branchColor;
            ctx.lineWidth = width;
            ctx.lineCap = "round";
            ctx.stroke();
            
            if(len < 10) {
                // Draw Heart at tip
                ctx.fillStyle = bloomColors[Math.floor(len)%bloomColors.length];
                // Pulse logic based on global frame
                let scale = 1 + 0.2 * Math.sin(frame * 0.1);
                
                ctx.font = `${Math.floor(15 * scale)}px Arial`;
                ctx.fillText("‚ù§", -6, 0); // Center the heart
                ctx.restore();
                return;
            }
            
            ctx.translate(0, -len);
            
            // Static Logic to prevent "shaking" (Hibijibi)
            // We re-run math every frame but logic determines the shape
            // To animate growing: We would normally lerp lengths. 
            // For simplicity and "Best Visuals" w/o massive code, we draw fully bloom tree with Sway
            
            let sway = 0.02 * Math.sin(frame * 0.02 + len); // Gentle wind
            
            drawRecursiveTree(0, 0, len * 0.75, 0.4 + sway, width * 0.7);
            drawRecursiveTree(0, 0, len * 0.75, -0.4 + sway, width * 0.7);
            
            ctx.restore();
        }

        function animationLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // 1. Stars Layer
            drawStars();
            
            // 2. Tree Layer
            // Align tree to bottom right
            const treeBaseX = canvas.width > 800 ? canvas.width - 250 : canvas.width / 2;
            const treeBaseY = canvas.height;
            
            // Call recursive draw
            drawRecursiveTree(treeBaseX, treeBaseY, 130, 0, 12); // Start Length 130

            frame++;
            requestAnimationFrame(animationLoop);
        }

        // ============ 3. TEXT TYPEWRITER & TIMER ============ //
        const titleEl = document.getElementById('special-heading');
        const msgEl = document.getElementById('special-msg');
        const timerDiv = document.getElementById('timer');
        
        let isBday = false;
        
        // Date Check
        function checkDate() {
            const now = new Date().getTime();
            const target = new Date(CONFIG.targetDate).getTime();
            const dist = target - now;
            
            if(dist <= 0) isBday = true;
            
            // Update Timer
            if(!isBday) {
                const d = Math.floor(dist / (1000 * 60 * 60 * 24));
                const h = Math.floor((dist % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const m = Math.floor((dist % (1000 * 60 * 60)) / (1000 * 60));
                const s = Math.floor((dist % (1000 * 60)) / 1000);
                
                timerDiv.innerHTML = `
                    <div class="t-box"><span class="t-val">${d}</span><span class="t-lbl">Days</span></div>
                    <div class="t-box"><span class="t-val">${h}</span><span class="t-lbl">Hours</span></div>
                    <div class="t-box"><span class="t-val">${m}</span><span class="t-lbl">Mins</span></div>
                    <div class="t-box"><span class="t-val">${s}</span><span class="t-lbl">Secs</span></div>`;
            } else {
                timerDiv.innerHTML = `<div class="t-box" style="width:100%"><span class="t-val">ENJOY YOUR DAY!</span></div>`;
            }
            return isBday;
        }
        setInterval(checkDate, 1000);
        
        // Typing
        async function typeText(text, el, speed = 50) {
            for(let i=0; i<text.length; i++) {
                if(text[i] === "\n") el.innerHTML += "<br>";
                else el.innerHTML += text[i];
                await new Promise(r => setTimeout(r, speed));
            }
            el.innerHTML += `<span class="cursor"></span>`; // Add blinking cursor at end
        }

        // ============ 4. YOUTUBE API INTEGRATION ============ //
        var player;
        // This function is called automatically by YouTube API
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '0',
                width: '0',
                videoId: CONFIG.ytVideoID,
                playerVars: {
                    'autoplay': 1,
                    'controls': 0,
                    'loop': 1,
                    'playlist': CONFIG.ytVideoID
                },
                events: {
                    'onReady': onPlayerReady
                }
            });
        }
        
        function onPlayerReady(event) {
            // Video loaded but waiting for user interaction
        }

        // ============ 5. INITIALIZATION & INTERACTION ============ //
        const overlay = document.getElementById('intro-overlay');
        
        overlay.addEventListener('click', () => {
            // 1. Fade out overlay
            overlay.style.opacity = '0';
            setTimeout(() => overlay.style.display = 'none', 1500);
            
            // 2. Start Music (Attempt Unmute/Play)
            if(player && typeof player.playVideo === "function") {
                player.unMute();
                player.playVideo();
            }
            
            // 3. Determine Content based on date
            const content = isBday ? CONFIG.texts.after : CONFIG.texts.before;
            
            // 4. Start Text Animation
            setTimeout(async () => {
                await typeText(content.head, titleEl, 80);
                await typeText(content.msg, msgEl, 40);
            }, 500);

            // 5. Start Canvas Animation
            animationLoop();
        });

        // Load YouTube API
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        // Init timer immediately for visual
        checkDate();

    </script>
</body>
</html>
